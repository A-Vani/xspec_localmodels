
!XSPEC12>data 1:1 work1.pha ;
#
#1 spectrum  in use
# 
#Spectral Data File: work1.pha  Spectrum 1
#Net count rate (cts/s) for Spectrum:1  5.887e-01 +/- 2.615e-03 (99.5 % total)
# After correction of 8.805e-04 (using cornorm 1.000)
# Assigned to Data Group 1 and Plot Group 1
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 10
#    2: 10
#    3: 0
#    4: 0
#    5: 360
# Using fit statistic: chi
# Using Background File                tprof_reg1_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg1_bi.cor
# Using Response (RMF) File            tprof_reg1_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg1_bi.arf
#
#
!XSPEC12>data 2:2 work2.pha ;
#
#2 spectra  in use
# 
#Spectral Data File: work2.pha  Spectrum 2
#Net count rate (cts/s) for Spectrum:2  4.592e-01 +/- 2.315e-03 (99.2 % total)
# After correction of 1.011e-03 (using cornorm 1.000)
# Assigned to Data Group 2 and Plot Group 2
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 15
#    2: 15
#    3: 0
#    4: 0
#    5: 329.1
# Using fit statistic: chi
# Using Background File                tprof_reg2_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg2_bi.cor
# Using Response (RMF) File            tprof_reg2_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg2_bi.arf
#
#
!XSPEC12>data 3:3 work3.pha ;
#
#3 spectra  in use
# 
#Spectral Data File: work3.pha  Spectrum 3
#Net count rate (cts/s) for Spectrum:3  7.578e-01 +/- 2.981e-03 (98.9 % total)
# After correction of 2.122e-03 (using cornorm 1.000)
# Assigned to Data Group 3 and Plot Group 3
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 22.5
#    2: 22.5
#    3: 0
#    4: 0
#    5: 341.3
# Using fit statistic: chi
# Using Background File                tprof_reg3_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg3_bi.cor
# Using Response (RMF) File            tprof_reg3_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg3_bi.arf
#
#
!XSPEC12>data 4:4 work4.pha ;
#
#4 spectra  in use
# 
#Spectral Data File: work4.pha  Spectrum 4
#Net count rate (cts/s) for Spectrum:4  1.184e+00 +/- 3.740e-03 (98.4 % total)
# After correction of 4.325e-03 (using cornorm 1.000)
# Assigned to Data Group 4 and Plot Group 4
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 33.75
#    2: 33.75
#    3: 0
#    4: 0
#    5: 379.2
# Using fit statistic: chi
# Using Background File                tprof_reg4_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg4_bi.cor
# Using Response (RMF) File            tprof_reg4_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg4_bi.arf
#
#
!XSPEC12>data 5:5 work5.pha ;
#
#5 spectra  in use
# 
#Spectral Data File: work5.pha  Spectrum 5
#Net count rate (cts/s) for Spectrum:5  1.657e+00 +/- 4.455e-03 (97.5 % total)
# After correction of 8.552e-03 (using cornorm 1.000)
# Assigned to Data Group 5 and Plot Group 5
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 50.62
#    2: 50.62
#    3: 0
#    4: 0
#    5: 329.8
# Using fit statistic: chi
# Using Background File                tprof_reg5_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg5_bi.cor
# Using Response (RMF) File            tprof_reg5_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg5_bi.arf
#
#
!XSPEC12>data 6:6 work6.pha ;
#
#6 spectra  in use
# 
#Spectral Data File: work6.pha  Spectrum 6
#Net count rate (cts/s) for Spectrum:6  2.069e+00 +/- 5.043e-03 (95.8 % total)
# After correction of 1.594e-02 (using cornorm 1.000)
# Assigned to Data Group 6 and Plot Group 6
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 75.94
#    2: 75.94
#    3: 0
#    4: 0
#    5: 346.3
# Using fit statistic: chi
# Using Background File                tprof_reg6_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg6_bi.cor
# Using Response (RMF) File            tprof_reg6_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg6_bi.arf
#
#
!XSPEC12>data 7:7 work7.pha ;
#
#7 spectra  in use
# 
#Spectral Data File: work7.pha  Spectrum 7
#Net count rate (cts/s) for Spectrum:7  2.186e+00 +/- 5.335e-03 (92.1 % total)
# After correction of 2.795e-02 (using cornorm 1.000)
# Assigned to Data Group 7 and Plot Group 7
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 113.9
#    2: 113.9
#    3: 0
#    4: 0
#    5: 323.4
# Using fit statistic: chi
# Using Background File                tprof_reg7_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg7_bi.cor
# Using Response (RMF) File            tprof_reg7_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg7_bi.arf
#
#
!XSPEC12>data 8:8 work8.pha ;
#
#8 spectra  in use
# 
#Spectral Data File: work8.pha  Spectrum 8
#Net count rate (cts/s) for Spectrum:8  2.376e+00 +/- 5.888e-03 (84.8 % total)
# After correction of 5.000e-02 (using cornorm 1.000)
# Assigned to Data Group 8 and Plot Group 8
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 170.9
#    2: 170.9
#    3: 0
#    4: 0
#    5: 343.4
# Using fit statistic: chi
# Using Background File                tprof_reg8_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg8_bi.cor
# Using Response (RMF) File            tprof_reg8_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg8_bi.arf
#
#
!XSPEC12>data 9:9 work9.pha ;
#
#9 spectra  in use
# 
#Spectral Data File: work9.pha  Spectrum 9
#Net count rate (cts/s) for Spectrum:9  1.820e+00 +/- 5.812e-03 (70.5 % total)
# After correction of 7.347e-02 (using cornorm 1.000)
# Assigned to Data Group 9 and Plot Group 9
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 256.3
#    2: 256.3
#    3: 0
#    4: 0
#    5: 268.8
# Using fit statistic: chi
# Using Background File                tprof_reg9_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg9_bi.cor
# Using Response (RMF) File            tprof_reg9_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg9_bi.arf
#
#
!XSPEC12>data 10:10 work10.pha ;
#
#10 spectra  in use
# 
#Spectral Data File: work10.pha  Spectrum 10
#Net count rate (cts/s) for Spectrum:10  6.632e-01 +/- 4.042e-03 (55.3 % total)
# After correction of 2.136e-02 (using cornorm 1.000)
# Assigned to Data Group 10 and Plot Group 10
#  Noticed Channels:  1-38
#  Telescope: CHANDRA Instrument: ACIS  Channel Type: PI
#  Exposure Time: 8.684e+04 sec
#  Filtering Keys: 
#    1: 384.4
#    2: 384.4
#    3: 0
#    4: 0
#    5: 87.86
# Using fit statistic: chi
# Using Background File                tprof_reg10_bi.bg
#  Background Exposure Time: 1 sec
# Using Correction File                tprof_reg10_bi.cor
# Using Response (RMF) File            tprof_reg10_bi.rmf for Source 1
# Using Auxiliary Response (ARF) File  tprof_reg10_bi.arf
#
#
!XSPEC12>ignore bad;
#
#ignore:     0 channels ignored from  source number 1
#ignore:     0 channels ignored from  source number 10
#ignore:     0 channels ignored from  source number 2
#ignore:     0 channels ignored from  source number 3
#ignore:     0 channels ignored from  source number 4
#ignore:     0 channels ignored from  source number 5
#ignore:     0 channels ignored from  source number 6
#ignore:     0 channels ignored from  source number 7
#ignore:     0 channels ignored from  source number 8
#ignore:     0 channels ignored from  source number 9
#
!XSPEC12>ignore **: **-0.5 **: 7.5-**;
#     5 channels (1-5) ignored in spectrum #     1
#     5 channels (1-5) ignored in spectrum #     2
#     5 channels (1-5) ignored in spectrum #     3
#     5 channels (1-5) ignored in spectrum #     4
#     5 channels (1-5) ignored in spectrum #     5
#     5 channels (1-5) ignored in spectrum #     6
#     5 channels (1-5) ignored in spectrum #     7
#     5 channels (1-5) ignored in spectrum #     8
#     5 channels (1-5) ignored in spectrum #     9
#     5 channels (1-5) ignored in spectrum #    10
#     6 channels (33-38) ignored in spectrum #     1
#     6 channels (33-38) ignored in spectrum #     2
#     6 channels (33-38) ignored in spectrum #     3
#     6 channels (33-38) ignored in spectrum #     4
#     6 channels (33-38) ignored in spectrum #     5
#     6 channels (33-38) ignored in spectrum #     6
#     6 channels (33-38) ignored in spectrum #     7
#     6 channels (33-38) ignored in spectrum #     8
#     6 channels (33-38) ignored in spectrum #     9
#     6 channels (33-38) ignored in spectrum #    10
#
#
!XSPEC12>set clmroot ..;
#
!XSPEC12>lmod clmass ${clmroot}/model;
#
!XSPEC12>lappend auto_path /ousley/mass/distrib/model
#
!XSPEC12>pkg_mkIndex /ousley/mass/distrib/model
#
!XSPEC12>pkg_mkIndex /ousley/mass/distrib/model
#
!XSPEC12>tclPkgUnknown clmass {}
#
!XSPEC12>load /ousley/mass/distrib/model/libclmass.so
#Model package clmass successfully loaded.
#
!XSPEC12>model nfwmass (wabs * mekal)  ;  /*;
#
#========================================================================
#Model nfwmass<1>(wabs<2>*mekal<3>) Source No.: 1   Active/On
#Model Model Component  Parameter  Unit     Value
# par  comp
#                           Data group: 1
#  23    2   wabs       nH         10^22    1.00000      +/-  0.0          
#  24    3   mekal      kT         keV      1.00000      +/-  0.0          
#  25    3   mekal      nH         cm-3     1.00000      frozen
#  26    3   mekal      Abundanc            1.00000      frozen
#  27    3   mekal      Redshift            0.0          frozen
#  28    3   mekal      switch              1            frozen
#  29    3   mekal      norm                1.00000      +/-  0.0          
#                           Data group: 2
#  52    2   wabs       nH         10^22    1.00000      = 23
#  53    3   mekal      kT         keV      1.00000      = 24
#  54    3   mekal      nH         cm-3     1.00000      = 25
#  55    3   mekal      Abundanc            1.00000      = 26
#  56    3   mekal      Redshift            0.0          = 27
#  57    3   mekal      switch              1            = 28
#  58    3   mekal      norm                1.00000      = 29
#                           Data group: 3
#  81    2   wabs       nH         10^22    1.00000      = 23
#  82    3   mekal      kT         keV      1.00000      = 24
#  83    3   mekal      nH         cm-3     1.00000      = 25
#  84    3   mekal      Abundanc            1.00000      = 26
#  85    3   mekal      Redshift            0.0          = 27
#  86    3   mekal      switch              1            = 28
#  87    3   mekal      norm                1.00000      = 29
#                           Data group: 4
# 110    2   wabs       nH         10^22    1.00000      = 23
# 111    3   mekal      kT         keV      1.00000      = 24
# 112    3   mekal      nH         cm-3     1.00000      = 25
# 113    3   mekal      Abundanc            1.00000      = 26
# 114    3   mekal      Redshift            0.0          = 27
# 115    3   mekal      switch              1            = 28
# 116    3   mekal      norm                1.00000      = 29
#                           Data group: 5
# 139    2   wabs       nH         10^22    1.00000      = 23
# 140    3   mekal      kT         keV      1.00000      = 24
# 141    3   mekal      nH         cm-3     1.00000      = 25
# 142    3   mekal      Abundanc            1.00000      = 26
# 143    3   mekal      Redshift            0.0          = 27
# 144    3   mekal      switch              1            = 28
# 145    3   mekal      norm                1.00000      = 29
#                           Data group: 6
# 168    2   wabs       nH         10^22    1.00000      = 23
# 169    3   mekal      kT         keV      1.00000      = 24
# 170    3   mekal      nH         cm-3     1.00000      = 25
# 171    3   mekal      Abundanc            1.00000      = 26
# 172    3   mekal      Redshift            0.0          = 27
# 173    3   mekal      switch              1            = 28
# 174    3   mekal      norm                1.00000      = 29
#                           Data group: 7
# 197    2   wabs       nH         10^22    1.00000      = 23
# 198    3   mekal      kT         keV      1.00000      = 24
# 199    3   mekal      nH         cm-3     1.00000      = 25
# 200    3   mekal      Abundanc            1.00000      = 26
# 201    3   mekal      Redshift            0.0          = 27
# 202    3   mekal      switch              1            = 28
# 203    3   mekal      norm                1.00000      = 29
#                           Data group: 8
# 226    2   wabs       nH         10^22    1.00000      = 23
# 227    3   mekal      kT         keV      1.00000      = 24
# 228    3   mekal      nH         cm-3     1.00000      = 25
# 229    3   mekal      Abundanc            1.00000      = 26
# 230    3   mekal      Redshift            0.0          = 27
# 231    3   mekal      switch              1            = 28
# 232    3   mekal      norm                1.00000      = 29
#                           Data group: 9
# 255    2   wabs       nH         10^22    1.00000      = 23
# 256    3   mekal      kT         keV      1.00000      = 24
# 257    3   mekal      nH         cm-3     1.00000      = 25
# 258    3   mekal      Abundanc            1.00000      = 26
# 259    3   mekal      Redshift            0.0          = 27
# 260    3   mekal      switch              1            = 28
# 261    3   mekal      norm                1.00000      = 29
#                           Data group: 10
# 284    2   wabs       nH         10^22    1.00000      = 23
# 285    3   mekal      kT         keV      1.00000      = 24
# 286    3   mekal      nH         cm-3     1.00000      = 25
# 287    3   mekal      Abundanc            1.00000      = 26
# 288    3   mekal      Redshift            0.0          = 27
# 289    3   mekal      switch              1            = 28
# 290    3   mekal      norm                1.00000      = 29
#------------------------------------------------------------------------
#   1    1   nfwmass    rinner     (scale)  0.0          
#   2    1   nfwmass    a                   0.0          +/-  0.0          
#   3    1   nfwmass    beta                0.700000     +/-  0.0          
#   4    1   nfwmass    switch              0            frozen
#   5    1   nfwmass    kTa        keV      1.00000      +/-  0.0          
#   6    1   nfwmass    kTb        keV      1.00000      +/-  0.0          
#   7    1   nfwmass    kTc        keV      1.00000      +/-  0.0          
#   8    1   nfwmass    kTd        keV      1.00000      +/-  0.0          
#   9    1   nfwmass    kTe        keV      1.00000      +/-  0.0          
#  10    1   nfwmass    kTf        keV      1.00000      +/-  0.0          
#  11    1   nfwmass    kTg        keV      1.00000      +/-  0.0          
#  12    1   nfwmass    kTh        keV      1.00000      +/-  0.0          
#  13    1   nfwmass    kTi        keV      1.00000      +/-  0.0          
#  14    1   nfwmass    kTj        keV      1.00000      +/-  0.0          
#  15    1   nfwmass    kTk        keV      1.00000      +/-  0.0          
#  16    1   nfwmass    kTl        keV      1.00000      +/-  0.0          
#  17    1   nfwmass    kTm        keV      1.00000      +/-  0.0          
#  18    1   nfwmass    kTn        keV      1.00000      +/-  0.0          
#  19    1   nfwmass    kTo        keV      1.00000      +/-  0.0          
#  20    1   nfwmass    kTp        keV      1.00000      +/-  0.0          
#  21    1   nfwmass    nfwa                1.00000      +/-  0.0          
#  22    1   nfwmass    nfwpot              1.00000      +/-  0.0          
#________________________________________________________________________
#
#
# Chi-Squared =   6.601449e+16 using 270 PHA bins.
# Reduced chi-squared =   2.672651e+14 for    247 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
!XSPEC12>newpar 23 0.0304;
#
# Chi-Squared =   3.469960e+18 using 270 PHA bins.
# Reduced chi-squared =   1.404842e+16 for    247 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
!XSPEC12>freeze 23;
#
# Chi-Squared =   3.469960e+18 using 270 PHA bins.
# Reduced chi-squared =   1.399177e+16 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
!XSPEC12>newpar 27 0.077947;
#
# Chi-Squared =   2.563367e+18 using 270 PHA bins.
# Reduced chi-squared =   1.033616e+16 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
!XSPEC12>thaw 26;
#
# Chi-Squared =   2.563367e+18 using 270 PHA bins.
# Reduced chi-squared =   1.037800e+16 for    247 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
!XSPEC12>newpar 29 1e-3 1e-5;
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.037231e+10 for    247 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
!XSPEC12>xset delta 0.01;
#Parameter delta values for fits will now be 0.01 * parValue
#
!XSPEC12>source ${clmroot}/tcl/mixcommon.tcl;
#
!XSPEC12>proc fixedPars {} {;    return 4;};
#
!XSPEC12>proc mixName {} {;    tclout compinfo 1;    return [lindex $xspec_tclout 0];};
#
!XSPEC12>proc mixNpars {} {;    tclout compinfo 1;    return [lindex $xspec_tclout 2];};
#
!XSPEC12>proc maxShells {} {;    set mixname [mixName];    return [${mixname}MaxShells [mixNpars]];};
#
!XSPEC12>proc frontend {mxName shName mxmName} {;    upvar $mxName maxshells $shName shells $mxmName mixname;    # Mixing component must be a known one;    set mixname [mixName];    if {![${mixname}Known]} {;	puts stderr "frontend: expecting a known mass model, got $mixname";	return 1;    };;    # Total number of mixing model parameters;    set mixpars [mixNpars];    # Number of beta model parameters;    set fixedpars [fixedPars];;    # Check names of last two fixed params and the first temperature;    tclout pinfo [expr $fixedpars - 1];    set betname [lindex $xspec_tclout 0];    tclout pinfo $fixedpars;    set swname [lindex $xspec_tclout 0];    tclout pinfo [expr $fixedpars + 1];    set ktfirst [lindex $xspec_tclout 0];    if {[string compare $betname beta] != 0 \;	    || [string compare $swname switch] != 0 \;	    || ![string match {kT*} $ktfirst]} {;	puts stderr "frontend: unexpected parameter names for $mixname";	return 1;    };;    # Maximum number of shells;    set maxshells [maxShells];    # Get number of active shells;    tclout datagrp;    set shells $xspec_tclout;    if {$shells > $maxshells} {;	puts stderr "frontend: too many shells - edit model.dat to increase";	return 1;    };    return 0;};
#
!XSPEC12>proc findParName {parName unitName {compNum 0}} {;    # Find the component with the named parameter;    if {$compNum} {;	set compStart $compNum;	set compEnd $compNum;    } else {;	tclout modcomp;	set compStart 1;	set compEnd $xspec_tclout;    };    for {set icomp $compStart} {$icomp <= $compEnd} {incr icomp} {;	tclout compinfo $icomp;	set pstart [lindex $xspec_tclout 1];	set pend [expr $pstart + [lindex $xspec_tclout 2] - 1];	for {set ipar $pstart} {$ipar <= $pend} {incr ipar} {;	    tclout pinfo $ipar;	    if {[string compare [lindex $xspec_tclout 0] $parName] == 0;	        ;; [string compare [lindex $xspec_tclout 1] $unitName] == 0} {;		return [list $icomp [expr $ipar - $pstart]];	    };	};    };    return {};};
#
!XSPEC12>proc massmod_start {{rinner 0} {a 0} {beta 0.7} {sw 0}} {;    # Sanity checks, etc;    if {[frontend maxshells shells mixname]} {;	return;    };;    # Identify thermal component;    set tmod [findParName kT keV];    if {[llength $tmod] != 2} {;	puts stderr "massmod_start: no thermal component";	return;    };    set thermcomp [lindex $tmod 0];    set thermoff [lindex $tmod 1];    tclout compinfo $thermcomp;    set thermname [lindex $xspec_tclout 0];;    # Link thermal model temperatures to clmass temperatures;    set fixedpars [fixedPars];    for {set igrp 1} {$igrp <= $shells} {incr igrp} {;	tclout compinfo $thermcomp $igrp;	if {[string compare [lindex $xspec_tclout 0] $thermname] != 0} {;	    puts stderr "massmod_start failed redundant check";	    return;	};	set thpar [expr [lindex $xspec_tclout 1] + $thermoff];	set mixtpar [expr $fixedpars + $igrp];	newpar $thpar =$mixtpar;    };;    # Freeze unused shell parameters;    if {$shells < $maxshells} {;	set ftstart [expr $fixedpars + $shells + 1];	set ftend [expr $fixedpars + $maxshells];	if {[${mixname}HasDens]} {;	    set fdstart [expr $ftstart + $maxshells];	    set fdend [expr $ftend + $maxshells];	    freeze $ftstart-$ftend $fdstart-$fdend;	} else {;	    freeze $ftstart-$ftend;	};    };;    # Set and freeze beta model params ;    newpar 1 $rinner;    newpar 2 $a;    newpar 3 $beta;    newpar 4 $sw;    freeze 2 3;    # Freeze density for the outermost shell when using the beta model;    if {$sw != 0 ;; [${mixname}HasDens]} {;	set extraden [expr $fixedpars + $maxshells + $shells];	freeze $extraden;    };};
#
!XSPEC12>proc breakLinks {{pars {{kT keV} {norm ""}}}} {;    # Find the component and offset of the first;    set p [lindex $pars 0];    set primePar [findParName [lindex $p 0] [lindex $p 1]];    if {[llength $primePar] != 2} {;	puts stderr "breakLinks: failed to find [lindex $p 0] in model";	return;    };    # Model component containing the primary parameter;    set comp [lindex $primePar 0];    set unlink [lindex $primePar 1];    # Offsets of the remaining parameters;    for {set i 1} {$i < [llength $pars]} {incr i} {;	set p [lindex $pars $i];	set pName [lindex $p 0];	set pUnit [lindex $p 1];	set pLoc [findParName $pName $pUnit $comp];	if {[llength $pLoc] != 2} {;	    puts stderr "breakLinks: no $pName in model component $comp";	    return;	};	lappend unlink [lindex $pLoc 1];    };    # Untie all from the first;    tclout datagrp;    set ndg $xspec_tclout;    set cmd untie;    for {set igrp 2} {$igrp <= $ndg} {incr igrp} {;	tclout compinfo $comp $igrp;	set pbase [lindex $xspec_tclout 1];	for {set j 0} {$j < [llength $unlink]} {incr j} {;	    lappend cmd [expr $pbase + [lindex $unlink $j]];	};    };    eval $cmd;    return;};
#
!XSPEC12>proc psave {saveName pnum} {;    tclout plink $pnum;    # Ignore linked parameters;    if {[string compare [lindex $xspec_tclout 0] F] == 0} {;	tclout param $pnum;	# Ignore frozen parameters;	if {[lindex $xspec_tclout 1] > 0} {;	    upvar $saveName saves;	    lappend saves [list $pnum [lindex $xspec_tclout 0]];	};    };    return;};
#
!XSPEC12>proc parsave {} {;# There should only be one copy of the mixing model, so deal;# with that first.;    tclout compinfo 1;    set mixpars [lindex $xspec_tclout 2];    for {set ipar 1} {$ipar <= $mixpars} {incr ipar} {;	# Save the parameter if it is variable; 	psave saves $ipar;    };    # Get number of model componnents;    tclout modcomp;    set ncomp $xspec_tclout;# Save the rest of the variable parameters.;    tclout datagrp;    set ndg $xspec_tclout;    for {set igrp 1} {$igrp <= $ndg} {incr igrp} {;	for {set icomp 2} {$icomp <= $ncomp} {incr icomp} {;	    tclout compinfo $icomp $igrp;	    set pbase [lindex $xspec_tclout 1];	    set pnum [lindex $xspec_tclout 2];	    set plast [expr $pbase + $pnum - 1];	    for {set ipar $pbase} {$ipar <= $plast} {incr ipar} {;		psave saves $ipar;	    };	};    };    return $saves;};
#
!XSPEC12>proc restore {savName} {;    upvar $savName saves;    set n [llength $saves];    tclout chatter;    set oldchatter $xspec_tclout;    chatter 5 5;    for {set i 0} {$i < $n} {incr i} {;	set pair [lindex $saves $i];	newpar [lindex $pair 0] [lindex $pair 1];    };    chatter [lindex $oldchatter 0] [lindex $oldchatter 1];    return;};
#
!XSPEC12>proc shellBounds {} {;    # Go through spectra to get rout for each shell;    tclout datasets;    set ndata $xspec_tclout;    for {set j 1} {$j <= $ndata} {incr j} {;	tclout datagrp $j;	set dgno $xspec_tclout;	tclout xflt $j;	# Make sure we have XFLT0001 at least;	if {[lindex $xspec_tclout 0] == 0} {;	    puts stderr "shellBounds: no XFLT keywords for dataset $j";	    return;	};	set rout [lindex $xspec_tclout 1];	# Get new entries and check those already seen;	if {[info exists dg($rout)]} {;	    if {$dg($rout) != $dgno} {;		puts stderr "shellBounds: mismatched shells";		return;	    };	} else {;	    set dg($rout) $dgno;	};    };    # Inner radius is first parameter;    tclout param 1;    set rprev [lindex $xspec_tclout 0];    # List shell boundaries and group number in radial order;    foreach r [lsort -real [array names dg]] {;	lappend rbounds [list $rprev $r $dg($r)];	set rprev $r;    };    return $rbounds;};
#
!XSPEC12>proc dgOfRadial {irad rbName} {;    upvar $rbName rbounds;    return [lindex [lindex $rbounds $irad] 2];};
#
!XSPEC12>proc rinOfRadial {irad rbName} {;    upvar $rbName rbounds;    return [lindex [lindex $rbounds $irad] 0];};
#
!XSPEC12>proc routOfRadial {irad rbName} {;    upvar $rbName rbounds;    return [lindex [lindex $rbounds $irad] 1];};
#
!XSPEC12>proc getz {} {;    # Identify thermal model component;    set tmod [findParName kT keV];    if {[llength $tmod] != 2} {;	puts stderr "getz: no thermal component";	return;    };    set thermcomp [lindex $tmod 0];    # Parameter number for the redshift;    set zpar [findParName Redshift "" $thermcomp];    if {[llength $zpar] != 2} {;	puts stderr "getz: no Redshift in component $thermcomp";	return;    };    tclout compinfo $thermcomp;    set zpnum [expr [lindex $xspec_tclout 1] + [lindex $zpar 1]];    tclout param $zpnum;    return [lindex $xspec_tclout 0];};
#
!XSPEC12>proc denPars {rbName} {;    upvar $rbName rbounds;    set fixedpars [fixedPars];    set dpbase [expr $fixedpars + [maxShells]];    set dpno [llength $rbounds];    # Density parameter for outermost shell is ignored when;    # the beta model is in use;    tclout param $fixedpars;    if {[lindex $xspec_tclout 0]} {;	incr dpno -1;    };    for {set i 0} {$i < $dpno} {incr i} {;	set pnum [expr $dpbase + [dgOfRadial $i rbounds]];	tclout pinfo $pnum;	# Append a list giving parameter name and number;	lappend dpnames [list [lindex $xspec_tclout 0] $pnum];    };    return $dpnames;};
#
!XSPEC12>proc cospars {z {cosfile stdcosmo.pars}} {;    set cno [exec ./cosinfo $cosfile $z];    regexp {^Angular diameter distance: (\S+) m\n} $cno junk angdd;    regexp {\nCritical density: (\S+) kg m\^{-3}} $cno junk rhocrit;    return [list $angdd $rhocrit];};
#
!XSPEC12>proc phyScale {dang radialScale} {;    set arcsec [expr $phyconst::pi / (180.0 * 3600.0)];    set runit [expr $radialScale * $arcsec * $dang];    # $$ M = M' {r \over r'} {kT \over (kT)'} {1 \over \mu m_H G} $$;    set Munit [expr $runit * $phyconst::keV \;		   / ($phyconst::mu * $phyconst::m_H * $phyconst::G_newton)];    set denunit [expr $Munit / ($runit * $runit * $runit)];    return [list $runit $denunit $Munit];};
#
!XSPEC12>proc setscales {radialScale rbName rmName mmName rcmName {redshift -1}} {;    # Shell boundaries;    upvar $rbName rbounds ;    set rbounds [shellBounds];    # Get redshift from model parameters if not provided by caller;    if {$redshift < 0.0} {;	set redshift [getz];    };    # Angular diameter distance and critical density;    set cpl [cospars $redshift];    set dang [lindex $cpl 0];    set dMpc [expr $dang / $phyconst::megaparsec];    puts "Angular diameter distance: $dMpc Mpc";    set rhocrit [lindex $cpl 1];    puts "Critical density: $rhocrit kg m^{-3}";    # Model scales in physical units;    set phscale [phyScale $dang $radialScale];    upvar $rmName runit;    set runit [lindex $phscale 0];    puts "Distance unit: [expr $runit / $phyconst::kiloparsec] kpc";    set denunit [lindex $phscale 1];    puts "Model density unit: $denunit kg m^{-3}";    upvar $mmName Munit;    set Munit [lindex $phscale 2];    puts "Model mass unit: [expr $Munit / $phyconst::Msun] Msun";    upvar $rcmName rcrit;    set rcrit [expr $rhocrit / $denunit];    puts "Critical density in model units: $rcrit";};
#
!XSPEC12>proc setMMkT {kTval nshell} {;    # Convenient to use 1 based count here;    set fixed [fixedPars];    for {set ishell 1} {$ishell <= $nshell} {incr ishell} {;	newpar [expr $fixed + $ishell] $kTval;    };};
#
!XSPEC12>proc rVirEstimate {kTval} {;    return [expr 2.74 * sqrt (0.1 * $kTval)];};
#
!XSPEC12>proc virialOverDensity {} {;    return 200;};
#
!XSPEC12>proc denIsothermal {rbName kTval rUnit rhoCritModel} {;    upvar $rbName rb;    set nshell [llength $rb];;    # Estimate the virial radius in Mpc;    set rvMpc [rVirEstimate $kTval];    # Virial radius in model units;    set rVirMod [expr $rvMpc * $phyconst::megaparsec / $rUnit];    # Density norm in model units, assuming mean density within;    # the virial radius is 200 times the critical density and;    # that the cluster is a perfect isothermal sphere.;    set overden [virialOverDensity];    set rhoNormMod [expr $overden * $rhoCritModel * $rVirMod * $rVirMod];;    set denList {};    for {set ishell 0} {$ishell < $nshell} {incr ishell} {;	set rin [rinOfRadial $ishell rb];	set rout [routOfRadial $ishell rb];	set rhoMod [expr $rhoNormMod / ($rout * ($rout + $rin) + $rin * $rin)];	lappend denList $rhoMod;    };    return $denList;};
#
!XSPEC12>proc NFWmassForm {x} {;    if {$x < 0.001} {;        return [expr $x * $x * (0.5 - $x * ((2.0 / 3.0) - $x * (0.75 \;		     - $x * (0.8 * $x))))];    };    return [expr log (1 + $x) - $x / (1 + $x)];};
#
!XSPEC12>proc denNFW {rbName nfwa conc rhoCritModel} {;    upvar $rbName rb;    set nshell [llength $rb];;    set overden [virialOverDensity];    set rhoNormMod [expr $overden * $rhoCritModel * $conc * $conc * $conc \;			/ [NFWmassForm $conc]];;    set denList {};    for {set ishell 0} {$ishell < $nshell} {incr ishell} {;	set xin [expr [rinOfRadial $ishell rb] / $nfwa];	set xout [expr [routOfRadial $ishell rb] / $nfwa];	set rhoMod [expr $rhoNormMod * \;		    ([NFWmassForm $xout] - [NFWmassForm $xin]) \;		    / (($xout - $xin) * ($xout * ($xout + $xin) + $xin * $xin))];	lappend denList $rhoMod;    };    return $denList;};
#
!XSPEC12>proc NFWguess {kTval conc rUnit rhoCritModel} {;    # Virial radius in Mpc;    set rvMpc [rVirEstimate $kTval];    # Virial radius in model units;    set rVirMod [expr $rvMpc * $phyconst::megaparsec / $rUnit];;    # NFW scale length in model units;    set NFWa [expr $rVirMod / $conc];    # NFW norm in model units;    set overden [virialOverDensity];    set NFWnorm [expr (4 * $phyconst::pi / 3) * $overden * $rhoCritModel \;		     * $rVirMod * $rVirMod * $conc / [NFWmassForm $conc]];    return [list $NFWa $NFWnorm];};
#
!XSPEC12>proc mixNFWstartPars {rbName kTval conc rUnit rhoCritModel} {;    upvar $rbName rb;    set mixmod [mixName];    return [${mixmod}NFWstartPars rb $kTval $conc $rUnit $rhoCritModel];};
#
!XSPEC12>proc applyConstraint {mass mcName} {;    upvar $mcName mcdat;    set dmmax 0.0;    set pivot -1;    # Find shell that contributes most to the mass;    foreach pv $mcdat {;	set pnum [lindex $pv 0];	tclout param $pnum;	set den [lindex $xspec_tclout 0];	set vol [lindex $pv 1];	set dm [expr $vol * $den];	if {$dm > $dmmax} {;	    set dmmax $dm;	    set pivot $pnum;	    set pvol $vol;	};    };    # Build and apply constraint string;    set onpvol [expr 1.0 / $pvol];    set straint [format " = %#.7g" [expr $mass * $onpvol]];    foreach pv $mcdat {;	set pnum [lindex $pv 0];	if {$pnum != $pivot} {;	    set vol [lindex $pv 1];	    set dfac [expr $vol * $onpvol];	    set straint [format "%s - %#.7g * %d" $straint $dfac $pnum];	};    };    newpar $pivot $straint;    return $pivot;};
#
!XSPEC12>proc massOfR {rcut rbName} {;    upvar $rbName rbounds;    tclout compinfo 1;    set mixname [lindex $xspec_tclout 0];    if {[${mixname}HasDens]} {;	# Density parameters and their related volumes;	set mcdat [${mixname}ConstraintData $rcut rbounds];	set mass 0.0;	foreach pv $mcdat {;	    set pnum [lindex $pv 0];	    tclout param $pnum;	    set dden [lindex $xspec_tclout 0];	    set vol [lindex $pv 1];	    set mass [expr $mass + $vol * $dden];	};    } else {;	set mass [${mixname}MofR $rcut rbounds];    };    return $mass;}    ;
#
!XSPEC12>proc fitConstrained {mfix rfix rbName} {;    upvar $rbName rbounds;    tclout compinfo 1;    set mixname [lindex $xspec_tclout 0];    # Density parameters and their related volumes;    set mcdat [${mixname}ConstraintData $rfix rbounds];    set oldpivot -1;    tclout chatter;    set oldchatter $xspec_tclout;    chatter 5 5;    while {[set pivot [applyConstraint $mfix mcdat]] != $oldpivot} {;	fit 100;	untie $pivot;	set oldpivot $pivot;    };    tclout stat;    untie $pivot;    chatter [lindex $oldchatter 0] [lindex $oldchatter 1];    return $xspec_tclout;};
#
!XSPEC12>proc avdsol {rhobar rbName} {;    upvar $rbName rbounds;    # Get list of shell densities;    tclout compinfo 1;    set mixname [lindex $xspec_tclout 0];    set dens [${mixname}ShellDensities rbounds];;    # Find all solutions;    set vnorm [expr 4.0 * $phyconst::pi / 3.0];    set mtot 0.0;    foreach sh $rbounds d $dens {;	if {[string length $d] > 0} {;	    set ri [lindex $sh 0];	    set numer [expr $mtot - $d * $vnorm * $ri * $ri * $ri];	    set denom [expr $rhobar - $d];	    if {$numer * $denom > 0.0} {;		set r [expr pow ($numer / ($vnorm * $denom), 1.0 / 3.0)];		if {$r >= $ri ;; $r < [lindex $sh 1]} {;		    if {$rhobar > $d} {;			lappend sols $r;		    } else {;			lappend sols -$r;		    };		};	    };	    set rout [lindex $sh 1];	    set mtot [expr $mtot + $d * $vnorm * ($rout - $ri) \;			  * ($rout * ($rout + $ri) + $ri * $ri)];	};    };    if {[info exists sols]} {;	return $sols;    };    return;};
#
!XSPEC12>proc fixedRad {rfix mass} {;    return $rfix;};
#
!XSPEC12>proc fixedDen {rhofix mass} {;    return [expr pow (0.75 * $mass / ($phyconst::pi * $rhofix), 1.0 / 3.0)];};
#
!XSPEC12>proc rmSolFixedRad {rfix rbName} {;    upvar $rbName rbounds;    set bestMass [massOfR $rfix rbounds];    return [list $rfix $bestMass];};
#
!XSPEC12>proc rmSolFixedDen {rhofix rbName} {;    upvar $rbName rbounds;    set sols [avdsol $rhofix rbounds];    # Deal with possible multiple solutions;    set np 0;    set nm 0;    foreach s $sols {;	if {$s > 0.0} {;	    incr np;	    if {![info exists rbest]} {;		set rbest $s;	    };	} else {;	    incr nm;	};    };    if {![info exists rbest]} {;	puts stderr "rmSolFixedDen: no radii with mean density $rhofix (-$nm)";	return ;    } elseif {$np > 1 || $nm > 0} {;	puts stderr "rmSolFixedDen: multiple solutions: -$nm +$np";    };    set vnorm [expr 4.0 * $phyconst::pi / 3.0];    set bestMass [expr $vnorm * $rhofix * $rbest * $rbest * $rbest];    return [list $rbest $bestMass];};
#
!XSPEC12>proc bracket {targetStat fixed epsStat min sin step rbName rprocName ;	      {bestStat 0} {tinyDs 0} {maxSlow 5}} {;    upvar $rbName rbounds;    if {$tinyDs <= 0.0} {;	# May need to tune this;	set tinyDs [expr 2.0 * $epsStat];    };    # Outer loop reduces step size until results seem reliable;    while {1} {;	set slowCount 0;	# Inner loop steps outward;	while {1} {;	    set pin [parsave];	    set mtry [expr $min * $step];	    set rtry [$rprocName $fixed $mtry];	    # Apply constraint and fit;	    set stry [fitConstrained $mtry $rtry rbounds];	    puts "radius, mass, stat: $rtry $mtry $stry";	    if {$stry < $bestStat - $epsStat} {;		# New best fit - return with params at the new fit;		return -1;	    };	    if {$stry > $targetStat + $epsStat} {;		# Apparent bracket found;		break;;	    };;	    if {$stry - $sin < $tinyDs ;		;; $targetStat - $stry > 2.0 * ($stry - $sin)} {;		# Repeated tiny steps when far from the target means ;		# step is too small;		incr slowCount;		if {$slowCount >= $maxSlow} {;		    puts "Increase step";		    set step [expr $step * $step];		};	    } else {;		set slowCount 0;	    };	    set min $mtry;	    set sin $stry;	};;	# Retry fit;	set schk [fitConstrained $mtry $rtry rbounds];	if {$schk < $bestStat - $epsStat} {;	    return -1;	};	puts "Refit outer limit: $rtry $mtry $schk";	if {$schk < $targetStat} {;	    # Not there yet;	    set min $mtry;	    set sin $schk;	} elseif {$stry - $schk < $epsStat} {;	    # Assume outer limit is OK;	    return [list $min $sin $pin $mtry $schk [parsave]];	} else {;	    # Return to inner point and rerun fit;	    restore pin;	    set rin [$rprocName $fixed $min];	    set sin [fitConstrained $min $rin rbounds];	    if {$sin < $bestStat - $epsStat} {;		return -1;	    };	    puts "revisit inner, radius, mass, stat: $rin $min $sin";	    set step [expr sqrt ($step)];	};    };};
#
!XSPEC12>proc MassLimit {targetStat min sin step fixed rbName epsStat rprocName} {;    upvar $rbName rbounds;    set asymmetry 30.0;    set statBest $sin;    # Bracket the mass limit;    set bkret [bracket $targetStat $fixed $epsStat $min $sin $step \;		   rbounds $rprocName $statBest];    if {$bkret == -1} {;	return -1;    };    set min [lindex $bkret 0];    set sin [lindex $bkret 1];    set pin [lindex $bkret 2];    set mout [lindex $bkret 3];    set sout [lindex $bkret 4];    set pout [lindex $bkret 5];    puts "Bounds: $min $sin $mout $sout";    # Restore parameters for inner limit, since it does better searching out;    restore pin;    puts "Refining";    # Use binary search, since analytical methods interact badly with;    # fickle fit results;    while {abs ($sout - $sin) > $epsStat} {;	# Refine limits on the mass at the confidence limit;	set mtry [expr 0.5 * ($min + $mout)];	set rtry [$rprocName $fixed $mtry];	set stry [fitConstrained $mtry $rtry rbounds];	if {$stry < $statBest - $epsStat} {;	    return -1;	} elseif {$stry > $targetStat} {;	    set mout $mtry;	    set sout $stry;	    set pout [parsave];	} elseif {$asymmetry * ($stry - $sin) < $sout - $stry} {;	    # Fit stat at the outer limit is suspect (also gets stry < sin);	    puts "Got $rtry $mtry $stry, searching out again";	    set bkret [bracket $targetStat $fixed $epsStat $mtry $stry \;			   [expr $mout / $min] rbounds $rprocName $statBest];	    if {$bkret == -1} {;		return -1;	    };	    set min [lindex $bkret 0];	    set sin [lindex $bkret 1];	    set pin [lindex $bkret 2];	    set mout [lindex $bkret 3];	    set sout [lindex $bkret 4];	    set pout [lindex $bkret 5];	    restore pin;	} else {;	    set min $mtry;	    set sin $stry;	};	puts "Bounds: $min $sin $mout $sout";    };    return [list $mout $pout];};
#
!XSPEC12>proc MassConf {quantFixed fixed rbName {delStat 1.0} {grow 1.03};		 {epsStat 0.01}} {;    # Save best fit info;    set bestFitPars [parsave];    # Compute constrained mass and radius at best fit;    upvar $rbName rbounds;    array set rmsProc {density rmSolFixedDen radius rmSolFixedRad};    set t [$rmsProc($quantFixed) $fixed rbounds];    set rbest [lindex $t 0];    set bestMass [lindex $t 1];    # Best fit statistic;    tclout stat;    set bestStat $xspec_tclout;    puts "Constrained best fit radius, mass and statistic:";    puts "  $rbest $bestMass $bestStat";;    # Lower confidence limit;    set targetStat [expr $bestStat + $delStat];    array set rProc {density fixedDen radius fixedRad};    set radProc $rProc($quantFixed);    set lowlim [MassLimit $targetStat $bestMass $bestStat [expr 1.0 / $grow] \;		    $fixed rbounds $epsStat $radProc];    if {$lowlim == -1} {; 	puts stderr "Better fit found.  Rerun fit now."; 	return;    };;    # Output density parameters at the lower limit.;    # Break parameter values out into an array.;    foreach prs [lindex $lowlim 1] {; 	set idx [lindex $prs 0]; 	set pvals($idx) "[lindex $prs 1]";    };    puts "Density parameters:";    set ct 0;    set diffpars [denPars rbounds];    foreach dp $diffpars {; 	set pnum [lindex $dp 1]; 	set val $pvals($pnum); 	if {$ct} {; 	    puts -nonewline ", [lindex $dp 0] $val"; 	} else {; 	    puts -nonewline "[lindex $dp 0] $val"; 	}; 	incr ct;    };    set mlow [lindex $lowlim 0];    set rlow [$radProc $fixed $mlow];    puts "\nLower bound radius, mass: $rlow $mlow";;    # Search up;    puts "Searching up";    restore bestFitPars;    set uplim [MassLimit $targetStat $bestMass $bestStat $grow $fixed \;		   rbounds $epsStat $radProc];    if {$uplim == -1} {;	puts stderr "Better fit found.  Rerun fit now.";	return;    };;    # Output density parameters at upper limit;    foreach prs [lindex $uplim 1] {; 	set idx [lindex $prs 0]; 	set pvals($idx) "[lindex $prs 1]";    };    puts "Density parameters:";    set ct 0;    foreach dp $diffpars {;	set pnum [lindex $dp 1];	set val $pvals($pnum);	if {$ct} {;	    puts -nonewline ", [lindex $dp 0] $val";	} else {;	    puts -nonewline "[lindex $dp 0] $val";	};	incr ct;    };    set mhi [lindex $uplim 0];    set rhi [$radProc $fixed $mhi];    puts "\nUpper bound radius, mass: $rhi $mhi";    ;    restore bestFitPars;    tclout chatter;    set oldchat $xspec_tclout;    chatter 5 5;    fit;    chatter [lindex $oldchat 0] [lindex $oldchat 1];;    return [list $bestMass $mlow $mhi];};
#
!XSPEC12>source ${clmroot}/tcl/phyconst.tcl;
#
!XSPEC12>source ${clmroot}/tcl/nfwmass.tcl;
#
!XSPEC12>proc nfwmassKnown {} {;    return 1;};
#
!XSPEC12>proc nfwmassMaxShells {mixpars} {;    return [expr $mixpars - 6];};
#
!XSPEC12>proc nfwmassHasDens {} {;    return 0;};
#
!XSPEC12>proc nfwmassMofR {r rbName} {;    tclout compinfo 1;    set mixpars [lindex $xspec_tclout 2];    set pnuma [expr $mixpars - 1];    set pnumpot $mixpars;    tclout pinfo $pnuma;    set pa [lindex $xspec_tclout 0];    tclout pinfo $pnumpot;    set ppot [lindex $xspec_tclout 0];    if {![string match nfwa $pa] || ![string match nfwpot $ppot]} {;	puts stderr "nfwmassMofR: wrong model parameters";	return;    };    tclout param $pnuma;    set nfwa [lindex $xspec_tclout 0];    tclout param $pnumpot;    set nfwpot [lindex $xspec_tclout 0];    return [expr $nfwpot * $nfwa * [NFWmassForm [expr $r / $nfwa]]];};
#
!XSPEC12>proc nfwmassNFWstartPars {rbName kTval conc rUnit rhoCritModel} {;    upvar $rbName rb;;    # Set temperatures;    set nshell [llength $rb];    setMMkT $kTval $nshell;;    # Estimate NFW parameters;    set nfwpar [NFWguess $kTval $conc $rUnit $rhoCritModel];;    # Set nfwa;    set pno [expr [fixedPars] + [maxShells] + 1];    set nfwa [lindex $nfwpar 0];    set alow [expr 0.01 * $nfwa];    set ahi [expr 100 * $nfwa];    # newpar arguments: <par number> <par value> <delta> <hard low>;    # <soft low> <soft high> <hard high>;    newpar $pno $nfwa $alow $alow $alow $ahi $ahi;;    # Set nfwnorm;    incr pno;    tclout param $pno;    set normmax [lindex $xspec_tclout 5];    set nfwnorm [lindex $nfwpar 1];    if {$nfwnorm > $normmax} {;	puts stderr "Estimated nfwnorm exceeds hard limit - unusable";	return;    };    set normhi [lindex $xspec_tclout 4];    set normlo [expr 0.01 * $nfwnorm];    set normup [expr 100 * $nfwnorm];    if {$normup < $normhi} {;	set normhi $normup;	set normmax $normup;    } elseif {$normup < $normmax} {;	set normmax $normup;    };    newpar $pno $nfwnorm $normlo $normlo $normlo $normhi $normmax;};
#
!XSPEC12>massmod_start 0 0 1.1 1;
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.033048e+10 for    248 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.008646e+10 for    254 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.008646e+10 for    254 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.008646e+10 for    254 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   2.561960e+12 using 270 PHA bins.
# Reduced chi-squared =   1.008646e+10 for    254 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   8.979477e+11 using 270 PHA bins.
# Reduced chi-squared =   3.535227e+09 for    254 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   8.979477e+11 using 270 PHA bins.
# Reduced chi-squared =   3.507608e+09 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
!XSPEC12>setscales 1.0 rbounds runit Munit rhocritmodel;
#Angular diameter distance: 304.171479722 Mpc
#Critical density: 9.90148691976e-27 kg m^{-3}
#Distance unit: 1.47466494773 kpc
#Model density unit: 1.16996687547e-18 kg m^{-3}
#Model mass unit: 55436787453.1 Msun
#Critical density in model units: 8.46304893528e-09
#
!XSPEC12>mixNFWstartPars rbounds 7 6 $runit $rhocritmodel;
#
# Chi-Squared =   2.661419e+15 using 270 PHA bins.
# Reduced chi-squared =   1.039617e+13 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   3.213149e+15 using 270 PHA bins.
# Reduced chi-squared =   1.255136e+13 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   3.742957e+15 using 270 PHA bins.
# Reduced chi-squared =   1.462093e+13 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   4.221807e+15 using 270 PHA bins.
# Reduced chi-squared =   1.649143e+13 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   4.630459e+15 using 270 PHA bins.
# Reduced chi-squared =   1.808773e+13 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   4.945540e+15 using 270 PHA bins.
# Reduced chi-squared =   1.931852e+13 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   5.066491e+15 using 270 PHA bins.
# Reduced chi-squared =   1.979098e+13 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   4.316388e+15 using 270 PHA bins.
# Reduced chi-squared =   1.686089e+13 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   8.144467e+14 using 270 PHA bins.
# Reduced chi-squared =   3.181432e+12 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   1.912338e+11 using 270 PHA bins.
# Reduced chi-squared =   7.470069e+08 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   1.923310e+11 using 270 PHA bins.
# Reduced chi-squared =   7.512932e+08 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
# Chi-Squared =   1.478154e+08 using 270 PHA bins.
# Reduced chi-squared =       577403.8 for    256 degrees of freedom 
# Null hypothesis probability =   0.000000e+00
# Current data and model not fit yet.
#
!XSPEC12>query yes;
#
!XSPEC12>fit;
#                    Parameters
#Chi-Squared  Lvl         5:kTa         6:kTb         7:kTc         8:kTd         9:kTe        10:kTf        11:kTg        12:kTh        13:kTi        14:kTj       21:nfwa     22:nfwpot   26:Abundanc       29:norm
#87578.5        0       7.17005       7.93575       6.78226       6.09895       5.75219       5.91669       6.37337       7.02408       7.79629       6.64508       260.386       52.7494       1.13495   7.34139e-05
#57560.1        0       7.33771       9.00921       6.32566       5.43407       5.13508       5.55711       6.23610       7.10396       8.66284       6.35731       262.393       52.5285       1.25669   7.70621e-05
#44804.7        0       7.45393       9.52874       5.59288       5.00974       4.88050       5.47264       6.24894       7.13305       9.51375       6.23802       263.836       52.3585       1.30150   7.96773e-05
#37472          0       7.54352       9.62155       4.87729       4.77267       4.77865       5.46584       6.28885       7.12301       10.2859       6.20078       264.969       52.2217       1.30808   8.17451e-05
#32240.2        0       7.61856       9.43929       4.31358       4.65675       4.74210       5.47746       6.32545       7.10054       10.9164       6.20402       265.905       52.1084       1.29618   8.35109e-05
#28467.5        0       7.68254       9.01709       3.91757       4.63167       4.73350       5.49002       6.35613       7.08244       11.4183       6.22758       266.659       52.0183       1.27339   8.50425e-05
#25771.9        0       7.73790       8.43389       3.64984       4.64917       4.73476       5.49861       6.38169       7.07378       11.8052       6.26161       267.271       51.9467       1.24366   8.63893e-05
#23880.8        0       7.78626       7.74246       3.48254       4.68994       4.73653       5.50369       6.40394       7.07476       12.1032       6.30119       267.768       51.8901       1.20881   8.75837e-05
#22414          0       7.83037       7.02085       3.37264       4.73575       4.73637       5.50606       6.42276       7.08321       12.2970       6.34209       268.207       51.8409       1.17239   8.86860e-05
#21127.1        0       7.87212       6.32147       3.30102       4.77844       4.73462       5.50677       6.43842       7.09645       12.4245       6.38235       268.624       51.7945       1.13642   8.97392e-05
#19887.7        0       7.91268       5.67803       3.25516       4.81996       4.73130       5.50674       6.45207       7.11233       12.5427       6.42190       269.031       51.7492       1.10226   9.07689e-05
#18649.8        0       7.95239       5.11186       3.22783       4.86000       4.72667       5.50652       6.46447       7.12996       12.6537       6.46104       269.426       51.7054       1.07039   9.17831e-05
#17401.3        0       7.99135       4.62379       3.21456       4.89677       4.72140       5.50654       6.47618       7.14883       12.7591       6.49989       269.806       51.6634       1.04105   9.27833e-05
#16186.9        0       8.02913       4.21939       3.21274       4.92918       4.71610       5.50715       6.48769       7.16890       12.8614       6.53885       270.160       51.6247       1.01368   9.37586e-05
#15220.4       -1       8.25270       2.42231       3.33402       5.00520       4.71246       5.56255       6.61588       7.39223       13.6879       6.89844       271.439       51.5303      0.816926   9.97222e-05
#7689.88       -2       8.68997       2.76130       3.81238       5.35628       5.11420       6.08337       7.35298       8.35332       16.3348       8.11337       259.764       53.5672      0.573335   0.000116005
#6624.22       -2       8.89529       2.98180       4.04737       5.75684       5.43159       6.45668       7.83833       8.91164       17.5536       8.72219       249.486       55.3790      0.566782   0.000127775
#6083.55       -2       9.02559       3.11920       4.26020       6.03886       5.66087       6.70197       8.06843       9.08844       17.7140       8.78988       240.565       57.0387      0.566958   0.000138677
#5686.2        -2       9.10615       3.24819       4.44003       6.23157       5.84894       6.86725       8.20052       9.10160       17.4764       8.64446       232.960       58.5165      0.567223   0.000149289
#5366.94       -2       9.15316       3.36634       4.58753       6.43795       6.00082       7.00293       8.29297       9.06614       17.1353       8.44280       226.361       59.8435      0.566557   0.000159980
#5114.42       -2       9.16623       3.47027       4.71224       6.62991       6.11417       7.11758       8.35532       9.00662       16.7557       8.22442       220.825       60.9824      0.564757   0.000170658
#4909.51       -2       9.15329       3.56816       4.81256       6.79820       6.22524       7.21359       8.41177       8.95315       16.4231       8.03066       216.106       61.9752      0.562717   0.000181518
#4731.89       -2       9.11943       3.65699       4.90929       6.94514       6.32912       7.30014       8.46538       8.90863       16.1352       7.86182       211.982       62.8571      0.560857   0.000192710
#4574.84       -2       9.06802       3.73703       5.00624       7.07492       6.42561       7.37983       8.51622       8.87091       15.8814       7.71233       208.311       63.6496      0.559293   0.000204343
#4435.24       -2       8.99985       3.80602       5.09708       7.19053       6.51236       7.45089       8.56151       8.83662       15.6533       7.57797       205.095       64.3491      0.556926   0.000216422
#4300.3        -2       8.91731       3.87597       5.17688       7.29699       6.59054       7.51278       8.59655       8.79318       15.4058       7.43516       202.154       64.9921      0.555256   0.000229086
#4171.77       -2       8.82248       3.94435       5.24991       7.39639       6.66296       7.56816       8.62626       8.74825       15.1515       7.29305       199.452       65.5857      0.554388   0.000242462
#4051.05       -2       8.71689       4.01032       5.31893       7.49258       6.73461       7.62854       8.66951       8.73472       15.0075       7.20709       197.029       66.1116      0.553321   0.000256662
#3933.66       -2       8.60085       4.07369       5.38317       7.58346       6.80242       7.68829       8.71515       8.73314       14.9096       7.14516       194.825       66.5834      0.552467   0.000271742
#3817.2        -2       8.47549       4.13496       5.44240       7.67037       6.86542       7.74572       8.75957       8.73622       14.8323       7.09501       192.794       67.0108      0.551727   0.000287811
#3700.23       -2       8.34164       4.19436       5.49690       7.75291       6.92387       7.79961       8.80155       8.74074       14.7660       7.05141       190.913       67.3987      0.551086   0.000304969
#3581.89       -2       8.19998       4.25186       5.54696       7.82959       6.97796       7.84940       8.84034       8.74515       14.7060       7.01192       189.173       67.7484      0.550457   0.000323306
#3461.42       -2       8.05134       4.30776       5.59272       7.90085       7.02780       7.89521       8.87592       8.74911       14.6511       6.97579       187.561       68.0624      0.549868   0.000342923
#3338.21       -2       7.89662       4.36235       5.63435       7.96699       7.07357       7.93722       8.90840       8.75254       14.6007       6.94265       186.066       68.3432      0.549318   0.000363924
#3211.88       -2       7.73676       4.41595       5.67199       8.02827       7.11548       7.97562       8.93792       8.75542       14.5542       6.91227       184.680       68.5926      0.548809   0.000386414
#3082.24       -2       7.57275       4.46882       5.70580       8.08494       7.15371       8.01058       8.96463       8.75777       14.5116       6.88446       183.394       68.8127      0.548331   0.000410486
#2949.24       -2       7.40556       4.52127       5.73589       8.13721       7.18843       8.04228       8.98866       8.75963       14.4725       6.85910       182.203       69.0053      0.547887   0.000436232
#2812.9        -2       7.23599       4.57380       5.76249       8.18538       7.21994       8.07100       9.01028       8.76112       14.4369       6.83616       181.098       69.1725      0.547744   0.000463756
#2673.86       -2       7.06533       4.62643       5.78563       8.22958       7.24822       8.09674       9.02944       8.76215       14.4045       6.81540       180.076       69.3152      0.547677   0.000493082
#2533.08       -2       6.89479       4.67932       5.80531       8.26981       7.27329       8.11954       9.04620       8.76272       14.3752       6.79677       179.138       69.4341      0.547621   0.000524205
#2390.49       -2       6.72580       4.73631       5.82074       8.30778       7.29620       8.14050       9.06153       8.76341       14.3493       6.78028       178.254       69.5363      0.547681   0.000557186
#2247.07       -2       6.56009       4.80150       5.83224       8.34614       7.31879       8.16144       9.07707       8.76506       14.3267       6.76570       177.376       69.6333      0.547991   0.000592199
#2106.16       -2       6.39863       4.86340       5.84379       8.38104       7.33882       8.17988       9.09045       8.76585       14.3053       6.75207       176.563       69.7118      0.547991   0.000628863
#1970.34       -2       6.24234       4.92319       5.85326       8.41127       7.35548       8.19506       9.10106       8.76564       14.2856       6.73975       175.837       69.7675      0.547757   0.000666714
#1841.92       -2       6.09234       4.98231       5.85941       8.43684       7.36866       8.20699       9.10899       8.76470       14.2682       6.72922       175.202       69.8004      0.547381   0.000705294
#1722.95       -2       5.94974       5.04028       5.86209       8.45759       7.37825       8.21562       9.11423       8.76314       14.2538       6.72070       174.662       69.8102      0.546867   0.000744072
#1613.48       -2       5.81445       5.09636       5.86124       8.47309       7.38408       8.22076       9.11668       8.76100       14.2426       6.71441       174.224       69.7963      0.546339   0.000782672
#1515.26       -2       5.68715       5.14999       5.85730       8.48353       7.38651       8.22277       9.11669       8.75857       14.2349       6.71052       173.883       69.7610      0.546218   0.000820597
#1429.51       -2       5.56928       5.20044       5.85036       8.48918       7.38557       8.22173       9.11430       8.75580       14.2305       6.70883       173.637       69.7055      0.545896   0.000857103
#1356.29       -2       5.46104       5.24677       5.84072       8.49008       7.38145       8.21775       9.10964       8.75270       14.2293       6.70923       173.483       69.6310      0.545439   0.000891638
#1294.98       -2       5.36242       5.28827       5.82870       8.48645       7.37436       8.21106       9.10289       8.74935       14.2311       6.71162       173.417       69.5394      0.544889   0.000923758
#1244.49       -2       5.27315       5.32443       5.81465       8.47864       7.36464       8.20195       9.09431       8.74583       14.2359       6.71586       173.433       69.4328      0.544294   0.000953146
#1203.46       -2       5.19279       5.35498       5.79896       8.46712       7.35265       8.19075       9.08417       8.74220       14.2432       6.72178       173.522       69.3137      0.543695   0.000979627
#1170.42       -2       5.12073       5.37988       5.78202       8.45243       7.33879       8.17785       9.07278       8.73856       14.2528       6.72916       173.674       69.1846      0.543128    0.00100316
#1148.35       -3       4.76846       5.38522       5.63267       8.26820       7.19499       8.04459       8.96253       8.71467       14.3866       6.82148       176.340       68.0256      0.538908    0.00109066
#1088.56       -4       4.44616       5.26636       5.41031       7.96055       6.97122       7.84149       8.80362       8.69344       14.6136       6.97227       182.897       66.6456      0.540810    0.00114975
#1020.04       -5       4.36051       5.20566       5.35128       7.88750       6.93881       7.83609       8.83142       8.73205       14.6243       6.96143       195.048       68.7090      0.545543    0.00115940
#1013.57       -6       4.33200       5.17755       5.33365       7.87060       6.94039       7.85491       8.86908       8.76270       14.6069       6.93589       204.067       70.5937      0.546402    0.00115915
#1013.14       -7       4.33017       5.17577       5.33245       7.86928       6.94024       7.85589       8.87142       8.76491       14.6061       6.93426       204.960       70.7809      0.546569    0.00115915
#1013.14        0       4.33017       5.17578       5.33245       7.86929       6.94024       7.85589       8.87141       8.76491       14.6061       6.93426       204.960       70.7809      0.546570    0.00115915
#==========================================================================================
# Variances and Principal Axes
#                 5        6        7        8        9       10       11       12       13       14       21       22       26       29  
# 1.3642E-12| -0.0006  -0.0001  -0.0001  -0.0000  -0.0000  -0.0000  -0.0000   0.0000   0.0000   0.0001  -0.0000   0.0001  -0.0002  -1.0000  
# 7.1019E-05|  0.0922   0.0910   0.2000   0.1554   0.4209   0.4546   0.3636   0.2239   0.0190  -0.5535   0.0302  -0.1605  -0.1393  -0.0001  
# 1.3377E-04| -0.1342  -0.1140  -0.2029  -0.0978  -0.1425   0.0050   0.1588   0.2799   0.0293  -0.2490  -0.0079   0.0200   0.8550  -0.0001  
# 1.8472E-04|  0.0919   0.1009   0.2443   0.1885   0.4663   0.2391  -0.1531  -0.5066  -0.0489   0.3170   0.0174  -0.0634   0.4736  -0.0002  
# 2.7860E-04| -0.3906  -0.3351  -0.5800  -0.1706   0.1394   0.4484   0.1897  -0.2576  -0.0351   0.1391  -0.0149   0.0503  -0.1530   0.0003  
# 4.4834E-04|  0.3093   0.1937   0.1517  -0.1432  -0.5972   0.3326   0.4910  -0.3124  -0.0523   0.1107   0.0065  -0.0298   0.0384  -0.0002  
# 6.9597E-04| -0.7407  -0.1631   0.5625   0.1688  -0.1609  -0.0711   0.2050  -0.0747  -0.0193   0.0263  -0.0028   0.0045  -0.0171   0.0004  
# 9.5954E-04|  0.1053  -0.0268  -0.1732   0.1329   0.2953  -0.6038   0.6685  -0.1674  -0.0682   0.0927   0.0043  -0.0240   0.0004  -0.0001  
# 2.5901E-03| -0.2685   0.5931   0.0703  -0.7011   0.2418  -0.0591   0.0671   0.0703  -0.0346   0.0808  -0.0050   0.0217   0.0027   0.0001  
# 3.3923E-03|  0.2826  -0.6296   0.3711  -0.4834   0.1720   0.0273   0.0845   0.2213  -0.1177   0.2257  -0.0089   0.0322   0.0025  -0.0001  
# 3.9792E-03| -0.0443   0.1951  -0.0794   0.3121   0.0059   0.1978   0.1331   0.5757  -0.3624   0.5765   0.0124  -0.0640   0.0046   0.0000  
# 4.0997E-02|  0.0165   0.0258   0.0262   0.0540   0.0519   0.0803   0.1417   0.1785   0.9120   0.3103  -0.0149   0.0783  -0.0010   0.0000  
# 4.5239E-01| -0.0537  -0.0676  -0.0612  -0.0969  -0.0717  -0.0708  -0.0609  -0.0122   0.0960   0.0641   0.2010  -0.9548   0.0003  -0.0000  
# 3.4230E+02|  0.0031   0.0031   0.0020   0.0019  -0.0001  -0.0020  -0.0041  -0.0033   0.0019   0.0028  -0.9785  -0.2059  -0.0000   0.0000  
#------------------------------------------------------------------------------------------
#
#========================================================================================================================================================================
#  Covariance Matrix
#        1           2           3           4           5           6           7           8           9          10          11          12          13          14   
#   5.624e-03   4.120e-03   3.725e-03   4.337e-03   1.660e-03  -3.774e-04  -2.790e-03  -3.105e-03   2.618e-04   1.704e-03  -1.054e+00  -1.976e-01   1.132e-05  -4.336e-07
#   4.120e-03   7.936e-03   3.284e-03   5.251e-03   2.073e-03   1.050e-04  -2.367e-03  -2.939e-03  -4.571e-05   1.449e-03  -1.056e+00  -1.918e-01   3.674e-06   4.990e-07
#   3.725e-03   3.284e-03   3.929e-03   3.268e-03   2.066e-03   6.851e-04  -8.775e-04  -1.620e-03  -4.531e-04   5.510e-04  -6.658e-01  -1.124e-01   7.696e-06   9.956e-09
#   4.337e-03   5.251e-03   3.268e-03   8.131e-03   2.533e-03   2.158e-03   2.847e-04  -1.040e-03  -1.173e-03  -9.432e-05  -6.476e-01  -9.255e-02  -1.384e-05   1.054e-07
#   1.660e-03   2.073e-03   2.066e-03   2.533e-03   3.018e-03   2.343e-03   2.593e-03   1.107e-03  -1.365e-03  -1.335e-03   3.784e-02   4.052e-02  -2.349e-06   3.394e-08
#  -3.774e-04   1.050e-04   6.851e-04   2.158e-03   2.343e-03   4.578e-03   5.045e-03   3.754e-03  -1.627e-03  -2.520e-03   6.696e-01   1.731e-01  -3.316e-06   1.411e-08
#  -2.790e-03  -2.367e-03  -8.775e-04   2.847e-04   2.593e-03   5.045e-03   8.911e-03   6.246e-03  -2.461e-04  -3.410e-03   1.363e+00   3.146e-01  -7.132e-06  -1.609e-08
#  -3.105e-03  -2.939e-03  -1.620e-03  -1.040e-03   1.107e-03   3.754e-03   6.246e-03   6.837e-03   3.114e-03   1.473e-04   1.117e+00   2.409e-01  -9.420e-07  -2.998e-08
#   2.618e-04  -4.571e-05  -4.531e-04  -1.173e-03  -1.365e-03  -1.627e-03  -2.461e-04   3.114e-03   4.004e-02   1.522e-02  -6.173e-01  -1.701e-01  -3.326e-05   4.995e-09
#   1.704e-03   1.449e-03   5.510e-04  -9.432e-05  -1.335e-03  -2.520e-03  -3.410e-03   1.473e-04   1.522e-02   1.004e-02  -9.281e-01  -2.233e-01   7.037e-06   1.061e-08
#  -1.054e+00  -1.056e+00  -6.658e-01  -6.476e-01   3.784e-02   6.696e-01   1.363e+00   1.117e+00  -6.173e-01  -9.281e-01   3.278e+02   6.888e+01   9.554e-04  -1.288e-05
#  -1.976e-01  -1.918e-01  -1.124e-01  -9.255e-02   4.052e-02   1.731e-01   3.146e-01   2.409e-01  -1.701e-01  -2.233e-01   6.888e+01   1.492e+01   5.661e-05  -2.166e-06
#   1.132e-05   3.674e-06   7.696e-06  -1.384e-05  -2.349e-06  -3.316e-06  -7.132e-06  -9.420e-07  -3.326e-05   7.037e-06   9.554e-04   5.661e-05   1.482e-04  -4.558e-08
#  -4.336e-07   4.990e-07   9.956e-09   1.054e-07   3.394e-08   1.411e-08  -1.609e-08  -2.998e-08   4.995e-09   1.061e-08  -1.288e-05  -2.166e-06  -4.558e-08   2.830e-10
#------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#
#========================================================================
#Model nfwmass<1>(wabs<2>*mekal<3>) Source No.: 1   Active/On
#Model Model Component  Parameter  Unit     Value
# par  comp
#                           Data group: 1
#  23    2   wabs       nH         10^22    3.04000E-02  frozen
#  24    3   mekal      kT         keV      4.33017      = 5
#  25    3   mekal      nH         cm-3     1.00000      frozen
#  26    3   mekal      Abundanc            0.546570     +/-  1.21738E-02  
#  27    3   mekal      Redshift            7.79470E-02  frozen
#  28    3   mekal      switch              1            frozen
#  29    3   mekal      norm                1.15915E-03  +/-  1.68215E-05  
#                           Data group: 2
#  52    2   wabs       nH         10^22    3.04000E-02  = 23
#  53    3   mekal      kT         keV      5.17578      = 6
#  54    3   mekal      nH         cm-3     1.00000      = 25
#  55    3   mekal      Abundanc            0.546570     = 26
#  56    3   mekal      Redshift            7.79470E-02  = 27
#  57    3   mekal      switch              1            = 28
#  58    3   mekal      norm                1.15915E-03  = 29
#                           Data group: 3
#  81    2   wabs       nH         10^22    3.04000E-02  = 23
#  82    3   mekal      kT         keV      5.33245      = 7
#  83    3   mekal      nH         cm-3     1.00000      = 25
#  84    3   mekal      Abundanc            0.546570     = 26
#  85    3   mekal      Redshift            7.79470E-02  = 27
#  86    3   mekal      switch              1            = 28
#  87    3   mekal      norm                1.15915E-03  = 29
#                           Data group: 4
# 110    2   wabs       nH         10^22    3.04000E-02  = 23
# 111    3   mekal      kT         keV      7.86929      = 8
# 112    3   mekal      nH         cm-3     1.00000      = 25
# 113    3   mekal      Abundanc            0.546570     = 26
# 114    3   mekal      Redshift            7.79470E-02  = 27
# 115    3   mekal      switch              1            = 28
# 116    3   mekal      norm                1.15915E-03  = 29
#                           Data group: 5
# 139    2   wabs       nH         10^22    3.04000E-02  = 23
# 140    3   mekal      kT         keV      6.94024      = 9
# 141    3   mekal      nH         cm-3     1.00000      = 25
# 142    3   mekal      Abundanc            0.546570     = 26
# 143    3   mekal      Redshift            7.79470E-02  = 27
# 144    3   mekal      switch              1            = 28
# 145    3   mekal      norm                1.15915E-03  = 29
#                           Data group: 6
# 168    2   wabs       nH         10^22    3.04000E-02  = 23
# 169    3   mekal      kT         keV      7.85589      = 10
# 170    3   mekal      nH         cm-3     1.00000      = 25
# 171    3   mekal      Abundanc            0.546570     = 26
# 172    3   mekal      Redshift            7.79470E-02  = 27
# 173    3   mekal      switch              1            = 28
# 174    3   mekal      norm                1.15915E-03  = 29
#                           Data group: 7
# 197    2   wabs       nH         10^22    3.04000E-02  = 23
# 198    3   mekal      kT         keV      8.87141      = 11
# 199    3   mekal      nH         cm-3     1.00000      = 25
# 200    3   mekal      Abundanc            0.546570     = 26
# 201    3   mekal      Redshift            7.79470E-02  = 27
# 202    3   mekal      switch              1            = 28
# 203    3   mekal      norm                1.15915E-03  = 29
#                           Data group: 8
# 226    2   wabs       nH         10^22    3.04000E-02  = 23
# 227    3   mekal      kT         keV      8.76491      = 12
# 228    3   mekal      nH         cm-3     1.00000      = 25
# 229    3   mekal      Abundanc            0.546570     = 26
# 230    3   mekal      Redshift            7.79470E-02  = 27
# 231    3   mekal      switch              1            = 28
# 232    3   mekal      norm                1.15915E-03  = 29
#                           Data group: 9
# 255    2   wabs       nH         10^22    3.04000E-02  = 23
# 256    3   mekal      kT         keV      14.6061      = 13
# 257    3   mekal      nH         cm-3     1.00000      = 25
# 258    3   mekal      Abundanc            0.546570     = 26
# 259    3   mekal      Redshift            7.79470E-02  = 27
# 260    3   mekal      switch              1            = 28
# 261    3   mekal      norm                1.15915E-03  = 29
#                           Data group: 10
# 284    2   wabs       nH         10^22    3.04000E-02  = 23
# 285    3   mekal      kT         keV      6.93426      = 14
# 286    3   mekal      nH         cm-3     1.00000      = 25
# 287    3   mekal      Abundanc            0.546570     = 26
# 288    3   mekal      Redshift            7.79470E-02  = 27
# 289    3   mekal      switch              1            = 28
# 290    3   mekal      norm                1.15915E-03  = 29
#------------------------------------------------------------------------
#   1    1   nfwmass    rinner     (scale)  0.0          
#   2    1   nfwmass    a                   0.0          frozen
#   3    1   nfwmass    beta                1.10000      frozen
#   4    1   nfwmass    switch              1            frozen
#   5    1   nfwmass    kTa        keV      4.33017      +/-  7.49964E-02  
#   6    1   nfwmass    kTb        keV      5.17578      +/-  8.90836E-02  
#   7    1   nfwmass    kTc        keV      5.33245      +/-  6.26837E-02  
#   8    1   nfwmass    kTd        keV      7.86929      +/-  9.01742E-02  
#   9    1   nfwmass    kTe        keV      6.94024      +/-  5.49395E-02  
#  10    1   nfwmass    kTf        keV      7.85589      +/-  6.76615E-02  
#  11    1   nfwmass    kTg        keV      8.87141      +/-  9.43975E-02  
#  12    1   nfwmass    kTh        keV      8.76491      +/-  8.26890E-02  
#  13    1   nfwmass    kTi        keV      14.6061      +/-  0.200101     
#  14    1   nfwmass    kTj        keV      6.93426      +/-  0.100224     
#  15    1   nfwmass    kTk        keV      1.00000      frozen
#  16    1   nfwmass    kTl        keV      1.00000      frozen
#  17    1   nfwmass    kTm        keV      1.00000      frozen
#  18    1   nfwmass    kTn        keV      1.00000      frozen
#  19    1   nfwmass    kTo        keV      1.00000      frozen
#  20    1   nfwmass    kTp        keV      1.00000      frozen
#  21    1   nfwmass    nfwa                204.960      +/-  18.1046      
#  22    1   nfwmass    nfwpot              70.7809      +/-  3.86326      
#________________________________________________________________________
#
#
# Chi-Squared =        1013.14 using 270 PHA bins.
# Reduced chi-squared =        3.95759 for    256 degrees of freedom 
# Null hypothesis probability =   1.361996e-90
#
!XSPEC12>breakLinks {{Abundanc ""}};
#
# Chi-Squared =        1013.14 using 270 PHA bins.
# Reduced chi-squared =        4.10179 for    247 degrees of freedom 
# Null hypothesis probability =   2.500895e-93
# Current data and model not fit yet.
#
!XSPEC12>new 287 =258;
#
!XSPEC12>newpar 287 =258
#
# Chi-Squared =        1013.14 using 270 PHA bins.
# Reduced chi-squared =        4.08525 for    248 degrees of freedom 
# Null hypothesis probability =   5.076745e-93
# Current data and model not fit yet.
#
!XSPEC12>fit;
#                    Parameters
#Chi-Squared  Lvl         5:kTa         6:kTb         7:kTc         8:kTd         9:kTe        10:kTf        11:kTg        12:kTh        13:kTi        14:kTj       21:nfwa     22:nfwpot   26:Abundanc       29:norm   55:Abundanc   84:Abundanc  113:Abundanc  142:Abundanc  171:Abundanc  200:Abundanc  229:Abundanc  258:Abundanc
#843.28        -3       4.37225       5.49841       5.46832       7.83970       6.89311       7.89844       8.83297       8.79917       14.6075       6.90142       207.128       70.2981      0.967794    0.00105671       1.24903      0.908354      0.594815      0.550864      0.622749      0.447805      0.463409      0.293814
#780.237       -3       4.42161       5.29475       5.43749       7.76374       6.83670       7.83926       8.79191       8.79114       14.6690       6.94414       209.420       69.9254       1.17002    0.00101211       1.07343      0.981628      0.609659      0.559179      0.621184      0.454540      0.461775      0.300535
#779.198       -4       4.48770       5.21905       5.38986       7.70683       6.80471       7.81421       8.78327       8.80152       14.7056       6.96185       214.546       70.4856       1.37785   0.000960233       1.03550      0.964265      0.608953      0.561770      0.619612      0.454934      0.460234      0.299397
#777.477       -5       4.41321       5.20302       5.35624       7.67455       6.81008       7.85348       8.85789       8.86148       14.6672       6.90754       234.421       74.5700       1.34014   0.000967580       1.10898      0.962415      0.606937      0.561420      0.618362      0.451284      0.458834      0.303276
#773.658       -6       4.40906       5.13311       5.33991       7.65013       6.81534       7.88634       8.91812       8.91166       14.6353       6.86160       253.761       78.5841       1.41522   0.000950535       1.05250      0.976174      0.602927      0.560703      0.617664      0.446670      0.457591      0.306942
#770.714       -7       4.38727       5.15995       5.33098       7.65019       6.81459       7.88898       8.92271       8.91679       14.6339       6.85771       256.898       79.2281       1.38060   0.000957830       1.10888      0.964847      0.606944      0.559860      0.617910      0.445177      0.457221      0.307534
#770.699       -8       4.40310       5.13617       5.33640       7.64731       6.81454       7.88853       8.92248       8.91671       14.6342       6.85787       256.980       79.2387       1.41409   0.000951025       1.06600      0.975233      0.603616      0.560408      0.617772      0.445184      0.457155      0.307564
#770.692       -9       4.38977       5.15547       5.33186       7.64942       6.81443       7.88879       8.92265       8.91682       14.6341       6.85777       256.989       79.2431       1.38650   0.000956670       1.10148      0.966954      0.606395      0.559980      0.617875      0.445146      0.457163      0.307561
#==========================================================================================
# Variances and Principal Axes
#                 5        6        7        8        9       10       11       12       13       14       21       22       26       29       55       84      113      142      171      200      229      258  
# 9.1813E-13| -0.0005  -0.0000  -0.0000  -0.0000  -0.0000  -0.0000  -0.0000   0.0000   0.0000   0.0000  -0.0000   0.0000  -0.0000  -1.0000  -0.0000  -0.0000  -0.0000  -0.0000  -0.0000  -0.0000  -0.0000  -0.0000  
# 5.6619E-05|  0.0720   0.0704   0.1567   0.1294   0.3606   0.3908   0.3255   0.2128   0.0225  -0.5027   0.0225  -0.1219  -0.0296  -0.0001  -0.0310  -0.0679  -0.0592  -0.1559  -0.1285  -0.0486   0.0790   0.4321  
# 1.2685E-04| -0.1456  -0.1366  -0.2884  -0.1977  -0.4407  -0.1934   0.1571   0.4647   0.0479  -0.2914  -0.0149   0.0576   0.0599   0.0001   0.0601   0.1242   0.0838   0.1652  -0.0297  -0.2431  -0.3396   0.2064  
# 1.9876E-04|  0.3564   0.2947   0.5035   0.1577  -0.1001  -0.3752  -0.1589   0.2204   0.0301  -0.1281   0.0108  -0.0408  -0.1461  -0.0002  -0.1270  -0.2033  -0.0197   0.2025   0.3115   0.0871  -0.1773   0.0883  
# 3.0651E-04| -0.2762  -0.1757  -0.1627   0.1021   0.4983  -0.2501  -0.3936   0.2544   0.0424  -0.0902  -0.0052   0.0238   0.1131   0.0001   0.0721   0.0470  -0.1011  -0.3213   0.2181   0.2279  -0.2855   0.0176  
# 4.9325E-04|  0.6802   0.1562  -0.4632  -0.1599   0.0997   0.1025  -0.1812   0.0628   0.0167  -0.0266   0.0020  -0.0049  -0.2783  -0.0003  -0.0392   0.2951   0.0982  -0.0938  -0.0645   0.1310  -0.0930  -0.0099  
# 6.2049E-04| -0.1314   0.0188   0.2019  -0.0832  -0.2506   0.4951  -0.4849   0.1276   0.0475  -0.0779  -0.0019   0.0106   0.0531   0.0001  -0.0179  -0.1116   0.0608   0.1251  -0.3660   0.3794  -0.2290  -0.0418  
# 8.8566E-04|  0.0822   0.0686   0.1571   0.0178   0.1244   0.0337   0.1259   0.0081  -0.0044  -0.1121   0.0078  -0.0387  -0.0411  -0.0000  -0.0420  -0.1046  -0.0483  -0.2463  -0.2568  -0.4162  -0.4685  -0.6171  
# 1.6078E-03| -0.0569   0.2337   0.1641  -0.4173   0.0156  -0.1927  -0.1437  -0.0362  -0.0581   0.3083  -0.0077   0.0440   0.0096   0.0000  -0.1418  -0.1220   0.1861  -0.4418  -0.2702  -0.2190  -0.0468   0.4396  
# 1.7611E-03|  0.2499  -0.4006  -0.0113   0.4642  -0.1942  -0.0759  -0.1546  -0.0686  -0.0354   0.1846   0.0002   0.0052  -0.1149  -0.0001   0.1937  -0.0951  -0.4091  -0.1139  -0.3056  -0.1668  -0.0944   0.2893  
# 2.3195E-03| -0.2614   0.6285  -0.2898   0.3982  -0.0759  -0.0029  -0.0701  -0.0754  -0.0091   0.0318   0.0079  -0.0323   0.0987   0.0001  -0.3373   0.1870  -0.2804   0.0716  -0.1108  -0.0839  -0.0842   0.0831  
# 2.8051E-03|  0.0025  -0.0512   0.0477   0.0319   0.3172   0.2772   0.0349  -0.1263  -0.1604   0.3621   0.0061  -0.0288   0.0290  -0.0000   0.0705   0.1040   0.1844   0.4407   0.1952  -0.2136  -0.4978   0.2555  
# 4.1577E-03| -0.0151  -0.0514   0.0139  -0.0477   0.0782  -0.1548  -0.3498  -0.5695   0.3445  -0.4914  -0.0061   0.0384   0.0286  -0.0000   0.0601   0.0842   0.1454   0.1779  -0.0656  -0.2736   0.0050   0.1127  
# 5.6449E-03|  0.0068   0.0140   0.1042   0.1295   0.2924  -0.1772  -0.2186   0.4267  -0.0784   0.0977   0.0030  -0.0137   0.0646  -0.0000   0.0904   0.2132   0.2029   0.3323  -0.4103  -0.2512   0.3912  -0.1252  
# 8.9036E-03| -0.0469  -0.0870  -0.3254  -0.1699   0.1299   0.1320  -0.2152   0.1284   0.0114   0.0073  -0.0055   0.0244  -0.2409   0.0000  -0.3089  -0.6358  -0.1823   0.2174   0.1251  -0.2768   0.1617  -0.0313  
# 1.1742E-02|  0.0378   0.0617   0.1410   0.0062  -0.2178   0.3794  -0.3373   0.1620  -0.0059   0.0146   0.0016  -0.0065   0.1261  -0.0000   0.1439   0.2521  -0.0875  -0.2669   0.4723  -0.4476   0.1985  -0.0369  
# 2.4521E-02| -0.2885  -0.2191   0.1105   0.2274  -0.0868   0.0333  -0.0213   0.0037  -0.0222  -0.0042   0.0034  -0.0161  -0.7004   0.0001  -0.3499   0.2545   0.3129  -0.1272   0.0495  -0.0246   0.0072  -0.0019  
# 3.8125E-02|  0.1240  -0.0065  -0.2314   0.4500  -0.1296   0.0272  -0.0398  -0.0186  -0.1354  -0.0440   0.0075  -0.0360   0.3077  -0.0001  -0.0381  -0.3504   0.6565  -0.1832   0.0574  -0.0243   0.0083  -0.0025  
# 4.2788E-02| -0.0319  -0.0117  -0.0005  -0.1182  -0.0324  -0.0868  -0.1411  -0.1674  -0.8996  -0.3166   0.0136  -0.0720  -0.0350   0.0000   0.0307   0.0386  -0.0921   0.0309  -0.0084   0.0045   0.0162  -0.0060  
# 8.9372E-02|  0.2122  -0.3873   0.1189  -0.0566   0.0123  -0.0019   0.0007  -0.0035  -0.0180  -0.0085  -0.0088   0.0374   0.4351  -0.0001  -0.7357   0.2163  -0.0888   0.0173  -0.0040   0.0019   0.0001   0.0003  
# 5.6295E-01| -0.0322  -0.0640  -0.0475  -0.0866  -0.0582  -0.0630  -0.0515  -0.0103   0.0897   0.0603   0.1982  -0.9607   0.0289  -0.0000  -0.0112   0.0088  -0.0044   0.0055  -0.0021   0.0018  -0.0023  -0.0037  
# 6.7334E+02| -0.0015  -0.0021  -0.0011  -0.0012   0.0002   0.0015   0.0028   0.0024  -0.0014  -0.0021   0.9794   0.2019   0.0009  -0.0000  -0.0002   0.0001  -0.0001  -0.0000  -0.0000  -0.0002  -0.0001   0.0002  
#------------------------------------------------------------------------------------------
#
#========================================================================================================================================================================================================================================================================
#  Covariance Matrix
#        1           2           3           4           5           6           7           8           9          10          11          12          13          14          15          16          17          18          19          20          21          22   
#   9.373e-03  -3.009e-03   2.630e-03   2.425e-03   1.009e-03  -2.411e-04  -1.794e-03  -2.104e-03   1.311e-04   1.188e-03  -9.827e-01  -1.837e-01   1.319e-02  -2.678e-06  -1.082e-02   6.118e-04  -4.810e-04  -3.595e-05   4.205e-05   1.066e-04   8.039e-05  -8.607e-05
#  -3.009e-03   2.121e-02  -1.346e-03   5.717e-03   1.678e-03   3.115e-04  -1.993e-03  -2.687e-03  -1.561e-04   1.349e-03  -1.364e+00  -2.465e-01  -1.321e-02   3.079e-06   2.767e-02  -8.343e-03   1.524e-03  -4.627e-04   1.384e-04   8.359e-05   1.205e-04  -9.857e-05
#   2.630e-03  -1.346e-03   7.447e-03  -4.772e-04   1.956e-03   5.489e-04  -5.661e-04  -1.304e-03  -4.640e-04   4.244e-04  -7.547e-01  -1.282e-01  -5.372e-04   2.151e-07  -6.597e-03   7.860e-03  -4.957e-03   3.870e-04  -1.583e-04   7.626e-05   5.561e-05  -2.938e-05
#   2.425e-03   5.717e-03  -4.772e-04   1.649e-02  -9.634e-05   2.761e-03   2.511e-04  -7.761e-04  -1.205e-03  -1.798e-04  -8.037e-01  -1.176e-01  -2.382e-03   7.080e-07   2.164e-03  -5.144e-03   1.386e-02  -4.189e-03   9.064e-04  -3.963e-04   1.475e-04   1.709e-06
#   1.009e-03   1.678e-03   1.956e-03  -9.634e-05   4.555e-03   1.170e-03   2.698e-03   1.094e-03  -1.278e-03  -1.331e-03   1.032e-01   5.447e-02  -7.914e-04   2.370e-07  -7.528e-05   2.132e-04  -3.023e-03   2.800e-03  -1.738e-03   2.377e-04  -1.206e-04   1.125e-04
#  -2.411e-04   3.115e-04   5.489e-04   2.761e-03   1.170e-03   6.679e-03   3.767e-03   4.093e-03  -1.623e-03  -2.665e-03   9.567e-01   2.330e-01  -8.021e-05   2.016e-08   9.155e-05  -2.893e-04   6.494e-04  -1.488e-03   2.973e-03  -2.154e-03   2.594e-04   1.369e-04
#  -1.794e-03  -1.993e-03  -5.661e-04   2.511e-04   2.698e-03   3.767e-03   1.073e-02   5.359e-03  -4.484e-05  -3.398e-03   1.872e+00   4.154e-01   9.248e-04  -2.900e-07  -2.119e-04   5.492e-05  -2.684e-04   6.497e-05  -1.373e-03   2.564e-03  -1.674e-03   4.163e-04
#  -2.104e-03  -2.687e-03  -1.304e-03  -7.761e-04   1.094e-03   4.093e-03   5.359e-03   8.205e-03   2.817e-03  -3.027e-04   1.598e+00   3.358e-01   1.215e-03  -3.767e-07  -2.656e-04   1.195e-04  -4.166e-05  -1.925e-04   1.637e-04  -1.247e-03   1.430e-03  -5.143e-04
#   1.311e-04  -1.561e-04  -4.640e-04  -1.205e-03  -1.278e-03  -1.623e-03  -4.484e-05   2.817e-03   4.183e-02   1.651e-02  -9.111e-01  -2.354e-01  -1.460e-06   3.342e-10   2.457e-06   6.390e-05   1.236e-05   9.557e-05  -3.160e-05   6.419e-05  -6.757e-04  -3.970e-05
#   1.188e-03   1.349e-03   4.244e-04  -1.798e-04  -1.331e-03  -2.665e-03  -3.398e-03  -3.027e-04   1.651e-02   1.115e-02  -1.395e+00  -3.207e-01  -6.551e-04   2.026e-07   1.486e-04  -3.733e-05   5.086e-05   1.158e-04   3.618e-06   2.269e-04  -4.697e-04   5.568e-05
#  -9.827e-01  -1.364e+00  -7.547e-01  -8.037e-01   1.032e-01   9.567e-01   1.872e+00   1.598e+00  -9.111e-01  -1.395e+00   6.459e+02   1.331e+02   6.127e-01  -1.886e-04  -1.426e-01   9.203e-02  -4.609e-02  -1.525e-02  -3.248e-02  -1.028e-01  -3.518e-02   9.856e-02
#  -1.837e-01  -2.465e-01  -1.282e-01  -1.176e-01   5.447e-02   2.330e-01   4.154e-01   3.358e-01  -2.354e-01  -3.207e-01   1.331e+02   2.798e+01   1.115e-01  -3.439e-05  -2.561e-02   1.485e-02  -8.139e-03  -5.970e-03  -5.619e-03  -2.218e-02  -5.992e-03   2.249e-02
#   1.319e-02  -1.321e-02  -5.372e-04  -2.382e-03  -7.914e-04  -8.021e-05   9.248e-04   1.215e-03  -1.460e-06  -6.551e-04   6.127e-01   1.115e-01   3.448e-02  -6.674e-06  -2.259e-02   1.960e-03  -7.239e-04   9.575e-05  -5.656e-05  -5.172e-05  -5.123e-05   4.683e-05
#  -2.678e-06   3.079e-06   2.151e-07   7.080e-07   2.370e-07   2.016e-08  -2.900e-07  -3.767e-07   3.342e-10   2.026e-07  -1.886e-04  -3.439e-05  -6.674e-06   1.449e-09   4.358e-06  -4.443e-07   1.536e-07  -2.937e-08   1.639e-08   1.573e-08   1.590e-08  -1.458e-08
#  -1.082e-02   2.767e-02  -6.597e-03   2.164e-03  -7.528e-05   9.155e-05  -2.119e-04  -2.656e-04   2.457e-06   1.486e-04  -1.426e-01  -2.561e-02  -2.259e-02   4.358e-06   5.312e-02  -1.374e-02   2.684e-03  -5.115e-04   8.688e-05  -2.366e-05   1.475e-05  -1.196e-05
#   6.118e-04  -8.343e-03   7.860e-03  -5.144e-03   2.132e-04  -2.893e-04   5.492e-05   1.195e-04   6.390e-05  -3.733e-05   9.203e-02   1.485e-02   1.960e-03  -4.443e-07  -1.374e-02   1.542e-02  -7.667e-03   7.604e-04  -2.479e-04   5.195e-05  -2.162e-05   2.192e-06
#  -4.810e-04   1.524e-03  -4.957e-03   1.386e-02  -3.023e-03   6.494e-04  -2.684e-04  -4.166e-05   1.236e-05   5.086e-05  -4.609e-02  -8.139e-03  -7.239e-04   1.536e-07   2.684e-03  -7.667e-03   2.126e-02  -5.269e-03   9.898e-04  -3.440e-04   5.568e-05  -1.387e-05
#  -3.595e-05  -4.627e-04   3.870e-04  -4.189e-03   2.800e-03  -1.488e-03   6.497e-05  -1.925e-04   9.557e-05   1.158e-04  -1.525e-02  -5.970e-03   9.575e-05  -2.937e-08  -5.115e-04   7.604e-04  -5.269e-03   4.779e-03  -2.136e-03   4.582e-04  -1.120e-04  -1.245e-06
#   4.205e-05   1.384e-04  -1.583e-04   9.064e-04  -1.738e-03   2.973e-03  -1.373e-03   1.637e-04  -3.160e-05   3.618e-06  -3.248e-02  -5.619e-03  -5.656e-05   1.639e-08   8.688e-05  -2.479e-04   9.898e-04  -2.136e-03   4.516e-03  -2.101e-03   3.511e-04  -6.189e-05
#   1.066e-04   8.359e-05   7.626e-05  -3.963e-04   2.377e-04  -2.154e-03   2.564e-03  -1.247e-03   6.419e-05   2.269e-04  -1.028e-01  -2.218e-02  -5.172e-05   1.573e-08  -2.366e-05   5.195e-05  -3.440e-04   4.582e-04  -2.101e-03   4.306e-03  -1.549e-03   1.066e-04
#   8.039e-05   1.205e-04   5.561e-05   1.475e-04  -1.206e-04   2.594e-04  -1.674e-03   1.430e-03  -6.757e-04  -4.697e-04  -3.518e-02  -5.992e-03  -5.123e-05   1.590e-08   1.475e-05  -2.162e-05   5.568e-05  -1.120e-04   3.511e-04  -1.549e-03   2.587e-03  -6.145e-04
#  -8.607e-05  -9.857e-05  -2.938e-05   1.709e-06   1.125e-04   1.369e-04   4.163e-04  -5.143e-04  -3.970e-05   5.568e-05   9.856e-02   2.249e-02   4.683e-05  -1.458e-08  -1.196e-05   2.192e-06  -1.387e-05  -1.245e-06  -6.189e-05   1.066e-04  -6.145e-04   1.204e-03
#------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#
#========================================================================
#Model nfwmass<1>(wabs<2>*mekal<3>) Source No.: 1   Active/On
#Model Model Component  Parameter  Unit     Value
# par  comp
#                           Data group: 1
#  23    2   wabs       nH         10^22    3.04000E-02  frozen
#  24    3   mekal      kT         keV      4.38977      = 5
#  25    3   mekal      nH         cm-3     1.00000      frozen
#  26    3   mekal      Abundanc            1.38650      +/-  0.185698     
#  27    3   mekal      Redshift            7.79470E-02  frozen
#  28    3   mekal      switch              1            frozen
#  29    3   mekal      norm                9.56670E-04  +/-  3.80695E-05  
#                           Data group: 2
#  52    2   wabs       nH         10^22    3.04000E-02  = 23
#  53    3   mekal      kT         keV      5.15547      = 6
#  54    3   mekal      nH         cm-3     1.00000      = 25
#  55    3   mekal      Abundanc            1.10148      +/-  0.230468     
#  56    3   mekal      Redshift            7.79470E-02  = 27
#  57    3   mekal      switch              1            = 28
#  58    3   mekal      norm                9.56670E-04  = 29
#                           Data group: 3
#  81    2   wabs       nH         10^22    3.04000E-02  = 23
#  82    3   mekal      kT         keV      5.33186      = 7
#  83    3   mekal      nH         cm-3     1.00000      = 25
#  84    3   mekal      Abundanc            0.966954     +/-  0.124193     
#  85    3   mekal      Redshift            7.79470E-02  = 27
#  86    3   mekal      switch              1            = 28
#  87    3   mekal      norm                9.56670E-04  = 29
#                           Data group: 4
# 110    2   wabs       nH         10^22    3.04000E-02  = 23
# 111    3   mekal      kT         keV      7.64942      = 8
# 112    3   mekal      nH         cm-3     1.00000      = 25
# 113    3   mekal      Abundanc            0.606395     +/-  0.145821     
# 114    3   mekal      Redshift            7.79470E-02  = 27
# 115    3   mekal      switch              1            = 28
# 116    3   mekal      norm                9.56670E-04  = 29
#                           Data group: 5
# 139    2   wabs       nH         10^22    3.04000E-02  = 23
# 140    3   mekal      kT         keV      6.81443      = 9
# 141    3   mekal      nH         cm-3     1.00000      = 25
# 142    3   mekal      Abundanc            0.559980     +/-  6.91296E-02  
# 143    3   mekal      Redshift            7.79470E-02  = 27
# 144    3   mekal      switch              1            = 28
# 145    3   mekal      norm                9.56670E-04  = 29
#                           Data group: 6
# 168    2   wabs       nH         10^22    3.04000E-02  = 23
# 169    3   mekal      kT         keV      7.88879      = 10
# 170    3   mekal      nH         cm-3     1.00000      = 25
# 171    3   mekal      Abundanc            0.617875     +/-  6.72048E-02  
# 172    3   mekal      Redshift            7.79470E-02  = 27
# 173    3   mekal      switch              1            = 28
# 174    3   mekal      norm                9.56670E-04  = 29
#                           Data group: 7
# 197    2   wabs       nH         10^22    3.04000E-02  = 23
# 198    3   mekal      kT         keV      8.92265      = 11
# 199    3   mekal      nH         cm-3     1.00000      = 25
# 200    3   mekal      Abundanc            0.445146     +/-  6.56183E-02  
# 201    3   mekal      Redshift            7.79470E-02  = 27
# 202    3   mekal      switch              1            = 28
# 203    3   mekal      norm                9.56670E-04  = 29
#                           Data group: 8
# 226    2   wabs       nH         10^22    3.04000E-02  = 23
# 227    3   mekal      kT         keV      8.91682      = 12
# 228    3   mekal      nH         cm-3     1.00000      = 25
# 229    3   mekal      Abundanc            0.457163     +/-  5.08660E-02  
# 230    3   mekal      Redshift            7.79470E-02  = 27
# 231    3   mekal      switch              1            = 28
# 232    3   mekal      norm                9.56670E-04  = 29
#                           Data group: 9
# 255    2   wabs       nH         10^22    3.04000E-02  = 23
# 256    3   mekal      kT         keV      14.6341      = 13
# 257    3   mekal      nH         cm-3     1.00000      = 25
# 258    3   mekal      Abundanc            0.307561     +/-  3.47006E-02  
# 259    3   mekal      Redshift            7.79470E-02  = 27
# 260    3   mekal      switch              1            = 28
# 261    3   mekal      norm                9.56670E-04  = 29
#                           Data group: 10
# 284    2   wabs       nH         10^22    3.04000E-02  = 23
# 285    3   mekal      kT         keV      6.85777      = 14
# 286    3   mekal      nH         cm-3     1.00000      = 25
# 287    3   mekal      Abundanc            0.307561     = 258
# 288    3   mekal      Redshift            7.79470E-02  = 27
# 289    3   mekal      switch              1            = 28
# 290    3   mekal      norm                9.56670E-04  = 29
#------------------------------------------------------------------------
#   1    1   nfwmass    rinner     (scale)  0.0          
#   2    1   nfwmass    a                   0.0          frozen
#   3    1   nfwmass    beta                1.10000      frozen
#   4    1   nfwmass    switch              1            frozen
#   5    1   nfwmass    kTa        keV      4.38977      +/-  9.68128E-02  
#   6    1   nfwmass    kTb        keV      5.15547      +/-  0.145644     
#   7    1   nfwmass    kTc        keV      5.33186      +/-  8.62974E-02  
#   8    1   nfwmass    kTd        keV      7.64942      +/-  0.128413     
#   9    1   nfwmass    kTe        keV      6.81443      +/-  6.74914E-02  
#  10    1   nfwmass    kTf        keV      7.88879      +/-  8.17269E-02  
#  11    1   nfwmass    kTg        keV      8.92265      +/-  0.103590     
#  12    1   nfwmass    kTh        keV      8.91682      +/-  9.05811E-02  
#  13    1   nfwmass    kTi        keV      14.6341      +/-  0.204513     
#  14    1   nfwmass    kTj        keV      6.85777      +/-  0.105573     
#  15    1   nfwmass    kTk        keV      1.00000      frozen
#  16    1   nfwmass    kTl        keV      1.00000      frozen
#  17    1   nfwmass    kTm        keV      1.00000      frozen
#  18    1   nfwmass    kTn        keV      1.00000      frozen
#  19    1   nfwmass    kTo        keV      1.00000      frozen
#  20    1   nfwmass    kTp        keV      1.00000      frozen
#  21    1   nfwmass    nfwa                256.989      +/-  25.4142      
#  22    1   nfwmass    nfwpot              79.2431      +/-  5.28933      
#________________________________________________________________________
#
#
# Chi-Squared =         770.69 using 270 PHA bins.
# Reduced chi-squared =         3.1076 for    248 degrees of freedom 
# Null hypothesis probability =   6.134868e-55
#
!XSPEC12> quit
# XSPEC: quit
#